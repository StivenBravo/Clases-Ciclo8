<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <title>Mascotas</title>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
  <!-- font awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- fonts style -->
  <link href="https://fonts.googleapis.com/css?family=Dosis:400,500|Poppins:400,700&display=swap" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
  <style>
    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.7;
      }
    }
  </style>
</head>

<body>
  <div class="hero_area">
    <!-- header section strats -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <img src="/img/logo.png" alt="">
            <span>
              Mascotas
            </span>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <div class="d-flex mx-auto flex-column flex-lg-row align-items-center">
              <ul class="navbar-nav  ">
                <li class="nav-item active">
                  <a class="nav-link" href="#inicio">Inicio<span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#reserva-cita">Reserva tu cita</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link"
                    href="https://wa.me/51925012871?text=%C2%A1Tengo%20una%20emergencia!%20%C2%BFPuedo%20contactarme%20con%20ustedes%3F"
                    target="_blank">¿ Tienes una emergencia ?</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#ubicacion">Ubicación</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link"
                    href="https://wa.me/51925012871?text=%C2%A1Hola%20Veterinaria%20Mascotas!%20Tengo%20una%20consulta!"
                    target="_blank">Contacto</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="buy.html"> Comprar ahora </a>
                </li>
                <li class="nav-item" id="authMenuItem">
                  <a class="nav-link" href="/login" id="authLink">Inicia Sesión</a>
                </li>
              </ul>
              <form class="form-inline my-2 my-lg-0 ml-0 ml-lg-4 mb-3 mb-lg-0">
                <button class="btn  my-2 my-sm-0 nav_search-btn" type="submit"></button>
              </form>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->

    <!-- slider section -->
    <section id="inicio" class=" slider_section position-relative">
      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="container-fluid">
              <div class="row">
                <div class="col-md-4 offset-md-2">
                  <div class="slider_detail-box">
                    <h1>
                      Atención Professional
                      <span>
                        para tu Mascota
                      </span>
                    </h1>
                    <p>
                      Contamos con médicos especializados en el cuidado de tus engreidos.
                    </p>
                    <div class="btn-box">
                      <a href="buy.html" class="btn-1">
                        Comprar ahora
                      </a>
                      <a href="#reserva-cita" class="btn-2">
                        Disponibilidad de atención
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </section>
    <!-- end slider section -->
  </div>

  <!-- productos destacados section -->
  <section class="layout_padding" style="background-color: #f8f9fa;">
    <div class="container">
      <div class="heading_container text-center" style="margin-bottom: 50px;">
        <h2 style="color: #023b48; font-weight: 600; font-size: 36px;">
          Nuestros <span style="color: #0dc3ff;">Productos</span>
        </h2>
        <p style="color: #666; font-size: 16px; margin-top: 10px;">
          Los mejores productos para el cuidado de tu mascota
        </p>
      </div>

      <div id="productosDestacados"
        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px; margin-bottom: 30px;">
        <p class="text-center" style="grid-column: 1/-1;">Cargando productos...</p>
      </div>

      <div class="text-center">
        <a href="buy.html" class="btn"
          style="background: #0dc3ff; color: white; padding: 12px 40px; border-radius: 25px; text-decoration: none; font-weight: 600; display: inline-block; transition: all 0.3s;">
          Ver todos los productos →
        </a>
      </div>
    </div>
  </section>

  <!-- appointment section -->
  <section id="reserva-cita" class="appointment_section layout_padding">
    <div class="container">
      <div class="heading_container text-center">
        <h2>
          Disponibilidad de <span>Atenciones</span>
        </h2>
        <p>Reserva tu cita con nuestros veterinarios profesionales</p>
      </div>

      <!-- Alert para usuario no logueado -->
      <div id="alertLogin" class="alert alert-warning text-center" style="display: none;">
        <i class="fa fa-exclamation-triangle"></i>
        Debes <a href="/login" class="alert-link">iniciar sesión</a> para poder reservar una cita.
      </div>

      <!-- Notificación de citas aprobadas -->
      <div id="citasAprobadas" class="alert alert-success" style="display: none; margin-bottom: 20px;">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <i class="fa fa-check-circle fa-lg"></i>
            <strong class="ml-2">¡Tienes citas confirmadas!</strong>
          </div>
          <button class="btn btn-sm btn-success" id="btnVerCitas">
            <i class="fa fa-calendar-check"></i> Ver mis citas
          </button>
        </div>
        <div id="listaCitasAprobadas" class="mt-3" style="display: none;"></div>
      </div>

      <div class="appointment_container" id="appointmentContainer">
        <div class="row">
          <!-- Calendario semanal -->
          <div class="col-lg-7 col-md-12">
            <div class="calendar_box">
              <h4 class="calendar_title">Calendario de la Semana</h4>
              <div class="week_selector">
                <button class="btn btn-sm btn-outline-primary" id="prevWeek">
                  <i class="fa fa-chevron-left"></i> Anterior
                </button>
                <span id="weekRange" class="mx-3"></span>
                <button class="btn btn-sm btn-outline-primary" id="nextWeek">
                  Siguiente <i class="fa fa-chevron-right"></i>
                </button>
              </div>
              <div id="weekCalendar" class="week_calendar"></div>
            </div>
          </div>

          <!-- Formulario de reserva -->
          <div class="col-lg-5 col-md-12">
            <div class="appointment_form">
              <h4 class="form_title">Datos de la Cita</h4>
              <form id="formReserva">
                <div class="form-group">
                  <label>Veterinario *</label>
                  <select class="form-control" id="veterinario" name="veterinario" required>
                    <option value="">Seleccione un veterinario</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Fecha y Hora *</label>
                  <input type="datetime-local" class="form-control" id="fechaCita" name="fechaCita" required readonly>
                  <small class="form-text text-muted">Seleccione un horario del calendario</small>
                </div>

                <div class="form-group">
                  <label>Tu Nombre</label>
                  <input type="text" class="form-control" id="nombreCliente" name="nombreCliente" readonly>
                </div>

                <div class="form-group">
                  <label>Nombre de tu Mascota *</label>
                  <input type="text" class="form-control" id="nombreMascota" name="nombreMascota" required
                    placeholder="Ej: Firulais">
                </div>

                <div class="form-group">
                  <label>Especie *</label>
                  <select class="form-control" id="especie" name="especie" required>
                    <option value="">Seleccione la especie</option>
                    <option value="perro">Perro</option>
                    <option value="gato">Gato</option>
                    <option value="ave">Ave</option>
                    <option value="roedor">Roedor</option>
                    <option value="reptil">Reptil</option>
                    <option value="otro">Otro</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Tipo de Consulta *</label>
                  <select class="form-control" id="tipoCita" name="tipoCita" required>
                    <option value="">Seleccione el tipo</option>
                    <option value="consulta">Consulta General</option>
                    <option value="vacunacion">Vacunación</option>
                    <option value="control">Control</option>
                    <option value="emergencia">Emergencia</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Motivo de la Consulta *</label>
                  <textarea class="form-control" id="motivo" name="motivo" rows="3" required
                    placeholder="Describa brevemente el motivo de la consulta"></textarea>
                </div>

                <button type="submit" class="btn btn-primary btn-block" id="btnReservar">
                  <i class="fa fa-calendar-check"></i> Reservar Cita
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- end appointment section -->

  <!-- contact and map section -->
  <section id="ubicacion" class="contact_map_section">
    <div class="container py-5">
      <div class="container">
        <div class="row no-gutters">
          <!-- Contact Form Column -->
          <div class="col-md-6">
            <div class="form_container">
              <div style="width: 80%; max-width: 400px;">
                <form action="">
                  <div class="text-center mb-3">
                    <h3>
                      Contáctanos
                    </h3>
                  </div>
                  <div>
                    <input type="text" placeholder="Nombre">
                  </div>
                  <div>
                    <input type="text" placeholder="Número de teléfono">
                  </div>
                  <div>
                    <input type="email" placeholder="Correo electrónico">
                  </div>
                  <div>
                    <input type="text" class="message-box" placeholder="Mensaje">
                  </div>
                  <div class="d-flex justify-content-center">
                    <button>
                      ENVIAR
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- Map Column -->
          <div class="col-md-6">
            <div class="map_container" style="height: 500px; width: 100%;">
              <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3962.2891!2d-79.8407!3d-6.7647!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x904cef1234567890%3A0xabcdef!2sAv.%20Jos%C3%A9%20Balta%202220%2C%20Jos%C3%A9%20Leonardo%20Ortiz%2014002!5e0!3m2!1ses-419!2spe!4v1234567890!5m2!1ses-419!2spe"
                width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"
                referrerpolicy="no-referrer-when-downgrade">
              </iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- end contact and map section -->

  <!-- footer section -->
  <section class="container-fluid footer_section">
    <p>
      &copy; 2025 derechos reservados
      <a href="https://html.design/">Veterinaria Mascotas</a>
    </p>
  </section>
  <!-- footer section -->

  <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.js"></script>
  <script type="text/javascript" src="js/auth-navbar.js"></script>
  <script type="text/javascript" src="js/appointments.js"></script>

  <script>
    // Cargar productos destacados
    async function cargarProductosDestacados() {
      try {
        const response = await fetch('/api/productos');
        const data = await response.json();

        if (data.success) {
          // Filtrar productos disponibles y tomar los primeros 4
          const productosDisponibles = data.data
            .filter(p => p.estado === 'disponible')
            .slice(0, 4);

          const container = document.getElementById('productosDestacados');

          if (productosDisponibles.length === 0) {
            container.innerHTML = '<p class="text-center" style="grid-column: 1/-1;">No hay productos disponibles</p>';
            return;
          }

          container.innerHTML = productosDisponibles.map(producto => {
            let stockBadge = '';
            if (producto.stock === 0) {
              stockBadge = '<div style="position: absolute; top: 10px; right: 10px; background: #868e96; color: white; padding: 5px 10px; border-radius: 15px; font-size: 11px; font-weight: 600;"><i class="fa fa-times-circle"></i> No disponible</div>';
            } else if (producto.stock < 3) {
              stockBadge = '<div style="position: absolute; top: 10px; right: 10px; background: #ff6b6b; color: white; padding: 5px 10px; border-radius: 15px; font-size: 11px; font-weight: 600; animation: pulse 2s infinite;"><i class="fa fa-exclamation-triangle"></i> ¡Poco stock!</div>';
            }

            return `
              <div style="background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s; cursor: pointer; position: relative;" 
                   onmouseover="this.style.transform='translateY(-10px)'" 
                   onmouseout="this.style.transform='translateY(0)'"
                   onclick="window.location.href='buy.html'">
                ${stockBadge}
                <img src="${producto.imagen_url || 'https://via.placeholder.com/250x200?text=Sin+Imagen'}" 
                     alt="${producto.nombre}" 
                     style="width: 100%; height: 200px; object-fit: cover;"
                     onerror="this.src='https://via.placeholder.com/250x200?text=Sin+Imagen'">
                <div style="padding: 20px;">
                  <div style="display: inline-block; padding: 4px 12px; background: #0dc3ff; color: white; border-radius: 20px; font-size: 11px; font-weight: 500; margin-bottom: 10px; text-transform: uppercase;">
                    ${producto.categoria}
                  </div>
                  <h4 style="font-size: 16px; font-weight: 600; color: #023b48; margin-bottom: 8px; min-height: 40px;">
                    ${producto.nombre}
                  </h4>
                  <p style="font-size: 13px; color: #666; margin-bottom: 10px;">
                    <i class="fa fa-tag"></i> ${producto.marca || 'Sin marca'}
                  </p>
                  <div style="font-size: 22px; font-weight: 700; color: #0dc3ff;">
                    S/ ${parseFloat(producto.precio_venta).toFixed(2)}
                  </div>
                </div>
              </div>
            `;
          }).join('');
        }
      } catch (error) {
        console.error('Error al cargar productos:', error);
        document.getElementById('productosDestacados').innerHTML = '<p class="text-center" style="grid-column: 1/-1; color: #ff6b6b;">Error al cargar productos</p>';
      }
    }

    // Cargar productos al cargar la página
    document.addEventListener('DOMContentLoaded', cargarProductosDestacados);
  </script>
</body>

</html>